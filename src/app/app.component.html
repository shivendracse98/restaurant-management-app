<!-- ============================
     NAVIGATION BAR
============================ -->
<nav class="navbar">
  <div class="nav-left">
    <a class="logo" (click)="goHome()">
      <ng-container
        *ngIf="auth.isLoggedIn() && (auth.isAdmin() || auth.isStaff()) && auth.currentUser()?.restaurantName; else defaultLogo">
        {{ auth.currentUser()?.restaurantName }}
      </ng-container>
      <ng-template #defaultLogo>
        ğŸ´ TasteTown
      </ng-template>
    </a>
  </div>

  <div class="nav-right" *ngIf="auth.isLoggedIn()">
    <span class="welcome">
      ğŸ‘‹ {{ auth.currentUser()?.name || auth.currentUser()?.email }}
    </span>
    <button class="btn logout" (click)="logout()">Logout</button>
  </div>

  <!-- Hamburger Menu (Mobile Only) -->
  <button class="hamburger-menu" (click)="toggleMobileMenu()" [class.active]="isMobileMenuOpen">
    <span class="bar"></span>
    <span class="bar"></span>
    <span class="bar"></span>
  </button>

  <!-- Mobile Overlay -->
  <div class="mobile-overlay" *ngIf="isMobileMenuOpen" (click)="closeMobileMenu()"></div>

  <!-- Mobile Nav Links Container (Modified Structure) -->
  <div class="nav-links" [class.mobile-open]="isMobileMenuOpen" (click)="closeMobileMenu()">
    <!-- Guest Links -->
    <ng-container *ngIf="!auth.isLoggedIn(); else loggedLinks">
      <a routerLink="/home" routerLinkActive="active">Home</a>
      <a routerLink="/menu" routerLinkActive="active">Menu</a>
      <a routerLink="/login" routerLinkActive="active">Login</a>
      <a routerLink="/register" routerLinkActive="active">Register</a>
    </ng-container>

    <!-- Logged-in Links -->
    <ng-template #loggedLinks>
      <!-- Admin -->
      <ng-container *ngIf="auth.isAdmin(); else nonAdminLinks">
        <a routerLink="/admin/dashboard" routerLinkActive="active">Dashboard</a>
        <a routerLink="/admin/orders" routerLinkActive="active">Orders</a>
        <a routerLink="/admin/menu" routerLinkActive="active">Menu Mgmt</a>
        <a routerLink="/admin/payments" routerLinkActive="active">Payments</a>
        <a routerLink="/admin/staff" routerLinkActive="active">Staff</a> <!-- Added Missing Link -->
        <a routerLink="/staff/pos" routerLinkActive="active">POS</a>
      </ng-container>

      <!-- Staff -->
      <ng-template #nonAdminLinks>
        <ng-container *ngIf="auth.isStaff(); else customerLinks">
          <!-- POS -->
          <a [routerLink]="['/staff/pos']" [queryParams]="{ tab: 'order' }" routerLinkActive="active">
            POS
          </a>

          <!-- Today's Orders -->
          <a routerLink="/staff/today-orders" routerLinkActive="active">
            Today's Orders
          </a>

        </ng-container>

        <!-- Customer -->
        <ng-template #customerLinks>

          <!-- ğŸ“ Location / Restaurant Picker -->
          <div class="location-picker" *ngIf="currentTenantName">
            <span class="loc-icon">ğŸ“</span>
            <span class="loc-name">{{ currentTenantName }}</span>
            <a routerLink="/home" class="loc-change">Change</a>
          </div>

          <a routerLink="/customer/dashboard" routerLinkActive="active">Dashboard</a>
          <a routerLink="/menu" routerLinkActive="active">Menu</a>
          <a routerLink="/cart" routerLinkActive="active" class="cart-link">
            ğŸ›’ Cart
            <span class="badge" *ngIf="cartCount > 0">{{ cartCount }}</span>
          </a>
          <a routerLink="/orders" routerLinkActive="active">My Orders</a>
        </ng-template>
      </ng-template>
    </ng-template>

    <!-- Mobile-Only Logout -->
    <a *ngIf="auth.isLoggedIn()" (click)="logout()" class="mobile-logout" style="color: #c62828;">
      Logout
    </a>
  </div>
</nav>

<!-- ============================
     MAIN CONTENT
============================ -->
<main>
  <router-outlet></router-outlet>
</main>

<!-- ============================
     TOAST NOTIFICATION
============================ -->
<div class="toast" *ngIf="toastVisible">{{ toastMessage }}</div>