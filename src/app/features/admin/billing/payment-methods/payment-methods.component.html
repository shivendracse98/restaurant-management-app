<div class="payment-container">

    <header>
        <div class="header-left">
            <button class="btn-back" routerLink="/admin/billing">
                <mat-icon>arrow_back</mat-icon> Back
            </button>
            <h1>Payment Settings</h1>
        </div>
    </header>

    <div class="grid-layout">

        <!-- Payment Methods Section -->
        <div class="card methods-card">
            <div class="card-header">
                <h3>Payment Methods</h3>
                <button class="btn-primary" (click)="showAddCard = !showAddCard" *ngIf="!showAddCard">+ Add
                    Card</button>
            </div>

            <!-- Add Card Form -->
            <div class="add-card-form" *ngIf="showAddCard">
                <h4>Add New Card</h4>
                <div class="form-row">
                    <input type="text" placeholder="Card Number (0000 0000 0000 0000)" [(ngModel)]="newCard.cardNumber"
                        class="full-width">
                </div>
                <div class="form-row three-col">
                    <input type="text" placeholder="MM" [(ngModel)]="newCard.expMonth" maxlength="2">
                    <input type="text" placeholder="YYYY" [(ngModel)]="newCard.expYear" maxlength="4">
                    <input type="password" placeholder="CVC" [(ngModel)]="newCard.cvv" maxlength="3">
                </div>
                <div class="form-actions">
                    <button class="btn-secondary" (click)="showAddCard = false">Cancel</button>
                    <button class="btn-primary" (click)="addNewCard()">Save Card</button>
                </div>
            </div>

            <!-- Cards List -->
            <div class="cards-list">
                <div class="payment-item" *ngFor="let method of paymentMethods">
                    <div class="card-icon">
                        <mat-icon>credit_card</mat-icon>
                    </div>
                    <div class="card-details">
                        <span class="brand">{{ method.cardBrand }} ending in {{ method.last4 }}</span>
                        <span class="expiry">Expires {{ method.expMonth }}/{{ method.expYear }}</span>
                        <span class="badge default" *ngIf="method.isDefault">DEFAULT</span>
                    </div>
                    <div class="card-actions">
                        <button class="btn-link" *ngIf="!method.isDefault" (click)="setDefault(method.id!)">Make
                            Default</button>
                        <button class="btn-icon" (click)="deleteMethod(method.id!)"><mat-icon>delete</mat-icon></button>
                    </div>
                </div>

                <div class="empty-state" *ngIf="paymentMethods.length === 0 && !showAddCard">
                    <p>No payment methods added.</p>
                </div>
            </div>
        </div>

        <!-- Billing Contact Section -->
        <div class="card contact-card">
            <div class="card-header">
                <h3>Billing Contact</h3>
            </div>
            <div class="contact-form">
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" [(ngModel)]="contact.name" placeholder="John Doe">
                </div>
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" [(ngModel)]="contact.email" placeholder="finance@company.com">
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" [(ngModel)]="contact.phone" placeholder="+91 98765 43210">
                </div>
                <div class="form-group">
                    <label>Billing Address</label>
                    <textarea [(ngModel)]="contact.address" rows="3"
                        placeholder="123 Food Street, Tech Park"></textarea>
                </div>
                <div class="form-group">
                    <label>GST / Tax ID</label>
                    <input type="text" [(ngModel)]="contact.gstNumber" placeholder="22AAAAA0000A1Z5">
                </div>

                <div class="form-footer">
                    <button class="btn-primary" (click)="saveContact()" [disabled]="savingContact">
                        {{ savingContact ? 'Saving...' : 'Save Changes' }}
                    </button>
                </div>
            </div>
        </div>

    </div>
</div>